Build TicTacToe on AWS using EC2, IAM Role and DynamoDB
=====================================================
Dynamo DB is a NoSQL DB where AWS will manage the backend server
Dynamo DB is serverless
In this app, all the user information will be stored in the backend DB


EC2 Instance ----> App ----> When users enters any data in the application, that data should get stored in the DynamoDB
To establish the communication between the EC2 Instance and the DynamoDB, we will create IAM Role, and for that role we will give DynamoDBFullAccess. We will attach this role to the VM


1. Create IAM Role 
'Check' AWS Service ---> use case: EC2, 'Check' EC2 ---> Next ---> Add 'DynamoDBFullAccess' ---> Next ---> Name: Game-Role ---> Create Role

2. Launch VM (Amazon Linux 2 AMI, t2.micro, Open Port 5000) ---> Advanced ---> IAM Instance Profile: Select the IAM Role created above, Metadata accessible: Enabled, Metadata Version: V1 and V2 (token optional) [This metadata will help us to get the metadata generated by IAM Role we have attached] ---> Launch VM

3. Connect to the VM
sudo su

Installation Steps
----------------------------
Install Development Tools and Dependencies
Installs essential development tools and libraries needed for compiling and building software.
sudo yum groupinstall -y "Development Tools"

Installs development headers and libraries for OpenSSL, bzip2, and libffi, required for Python.
sudo yum install -y openssl-devel bzip2-devel libffi-devel

Install Python 2.7.18
Downloads Python 2.7.18, extracts it, configures the build with optimizations enabled, and installs it without replacing the system-provided Python.
cd /usr/src
sudo wget https://www.python.org/ftp/python/2.7.18/Python-2.7.18.tgz
sudo tar xzf Python-2.7.18.tgz
cd Python-2.7.18
sudo ./configure --enable-optimizations
sudo make altinstall

Verify the installed Python version.
python2.7 -V

Install pip for Python 2.7
Downloads and installs pip for Python 2.7.
wget https://bootstrap.pypa.io/pip/2.7/get-pip.py
python2.7 get-pip.py

Install Python Packages
Installs Flask, Boto (for AWS SDK), and configparser Python packages using pip.
pip install Flask
pip install boto
pip install configparser

Install Git
Installs Git, a version control system.
yum install git -y

Clone the TicTacToe Project Repository
Clones the TicTacToe project repository from GitHub into the /home/ec2-user/ directory.

cd /home/ec2-user/
git clone https://github.com/KastroVKiran/DynamoDB_AWS_Project.git


After executing the above last command ---> ls ---> cd <ClonedRepoName> ---> ls ---> You will see all the files ---> We need to do some configurations ---> vi config ---> Change the region and endpoint as per the region code ---> esc ---> :wq ---> vi config.ini ---> Here also change the region ---> esc ---> :wq

Lets run the application.py file which is there inside the cloned repo
python2.7 application.py --config config.ini --mode service --endpoint dynamodb.us-east-1.amazonaws.com --serverPort 5000

Access the app [Chrome browser] ---> <PublicIP>:5000 ---> You will see App ---> Enter any name on the top right side next to Login and click on Login ---> Click on 'Create Table' ---> Goto Dynamo DB, you will see 'Games' table. This table got created because of the setupDynamoDB.py file ---> Click on 'Games' tables ---> You dont see any items currently. Whenever we play a game, all those moves will be stored here. Lets see that practically.

Goto the browser where app is opened ---> Copy the public ip and 5000 and open the app in new browser [Firefox] (This is done because we need two players for the game) ---> Login as explained above

Goto Chrome browser ---> Click on 'Create' ---> Enter the name you have used to login in Firefox browser ---> Create game ---> Goto the Firefox browser and reload the page. You will see a request in Firefox browser. Accept it. ---> Play the game based on the 'turn' in the app. Finish the game successfully.

Lets verify the data in Dynamo DB ---> Goto Dynamo DB ---> Open the 'games'  ---> Click on 'Scan or query items' ---> 'Check' Scan ---> Click on RUN ---> You will see the details. ---> To know more details of the played game, click on the item and you can see each and every move got stored.


Deploy NodeJS app with PM2 on AWS EC2 instance 
=========================================
Lets see how to run a simple Node JS app using EC2 Instance
We will also create a simple index.html page in this demo

Launch VM - Amazon Linux 2 AMI, t2.micro
Connect to the VM
sudo su
You are in /home/ec2-user path

curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -

Run the following command to install nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash

After installation, load nvm into your shell session:
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

nvm --version

Install Node.js using nvm:
nvm install --lts

To see the list of nvm:
nvm ls-remote

nvm install 16

nvm use 16

node -v
npm -v

STEP 1: ADD REQUIRED REPO FROM OFFICIAL NODEJS WEBSITE.
curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -

STEP 2: INSTALL NODEJS.
sudo yum install -y nodejs

STEP 3: VERIFY INSTALLED VERSION.
node -v
npm -v

STEP 4: CREATE A server.js FILE AND RUN IT.
Create a file named server.js with the provided the below content.
Whenever we run this server.js file, it is going pick the content from index.html file and in this .js file we will also tell which protocol and port number has to be used.
The below script creates a http server which listens on Port 80 and it will read the content from index.html file and it will also send a response when someone access the server.
You can also change the port number, if required in the below content

vi server.js ----> Paste the below content ---->
const http = require('http');
const fs = require('fs');
const path = require('path');

const server = http.createServer((req, res) => {
  const filePath = path.join(__dirname, 'index.html');
  const stat = fs.statSync(filePath);

  res.writeHead(200, {
    'Content-Type': 'text/html',
    'Content-Length': stat.size,
  });

  const readStream = fs.createReadStream(filePath);
  readStream.pipe(res);
});

const PORT = 80;
server.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
});

----> esc ---> :wq
this script creates a basic web server that listens on port 80, reads the content of an index.html file, and sends it as the response when a request is made to the server. The server logs a message indicating that it is running on http://localhost:80.

Lets create the index.html file
vi index.html ---> Paste the below content ---> 

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome to Kastro-App-1</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f9;
      color: #333;
    }

    .banner {
      background-image: url('https://media.licdn.com/dms/image/v2/D5616AQEmUtBVk0Lw0Q/profile-displaybackgroundimage-shrink_350_1400/profile-displaybackgroundimage-shrink_350_1400/0/1716294939546?e=1745452800&v=beta&t=plGcHN9hOuLxuREa8Chsw4y2_muQ6vVCtaF01qGNwbE');
      background-size: cover;
      background-position: center;
      height: 200px; /* Reduced banner height */
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .header {
      font-size: 2.5rem;
      font-weight: bold;
      text-align: center;
      margin: 20px 0;
    }

    .profile-image {
      display: block;
      margin: 0 auto;
      border-radius: 50%;
      width: 150px;
      height: 150px;
      border: 5px solid #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .about-me {
      text-align: center;
      margin: 20px auto;
      max-width: 600px;
      padding: 20px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .about-me h2 {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .about-me p {
      font-size: 1.1rem;
      line-height: 1.6;
    }

    .youtube-button {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 1.2rem;
      color: #fff;
      background-color: #ff0000;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      transition: background-color 0.3s ease;
      width: fit-content;
    }

    .youtube-button:hover {
      background-color: #cc0000;
    }

    .youtube-button img {
      width: 24px;
      height: 24px;
      margin-right: 10px;
    }

    footer {
      text-align: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <div class="header">Welcome to Kastro-App-1</div>

  <div class="banner"></div>

  <div class="content">
    <img src="https://media.licdn.com/dms/image/v2/D5603AQHJB_lF1d9OSw/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1718971147172?e=1745452800&v=beta&t=TAEVuu-ImVTAJTvtMvtV4tzJV9aZM3iS4Ts1XrXAEsk" alt="Profile Image" class="profile-image">

    <div class="about-me">
      <h2>About Me</h2>
      <p><strong>Name:</strong> Kastro Kiran V</p>
      <p><strong>Role:</strong> AWS & DevOps Corporate Trainer</p>
      <p><strong>Education:</strong> PhD</p>
    </div>

    <a href="https://www.youtube.com/playlist?list=PLs-PsDpuAuTfG3gFR5DnVD58kT7JBO97x" class="youtube-button">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/YouTube_full-color_icon_%282017%29.svg/1024px-YouTube_full-color_icon_%282017%29.svg.png" alt="YouTube Icon">
      DevOps Projects
    </a>
  </div>

  <footer>
    <p>&copy; 2025 Kastro-App-1. All rights reserved.</p>
  </footer>
</body>
</html>

----> esc ---> :wq

STEP 5: INSTALL REQUIRED PACKAGES / INSTALL DEPENDENCIES.
npm install

STEP 6: NODE.JS WILL INTERPRET AND EXECUTE THE CODE IN THE server.js FILE. THIS IS A COMMON PATTERN FOR RUNNING SERVER-SIDE JAVASCRIPT APPLICATIONS.
node server.js

Goto the browser and access the Public IP ---> You will see app
Make sure to open port 80 for VM

Goto Moba and press Control + c. The website gets interrupted. 
Go to the browser and refresh. You will see "This site cant be reached". This is because the app is running in interactive mode.

So we need to run this in detached mode. For this we need to work with pm2

Command to install pm2
npm install -g pm2

list all running processes/apps.
pm2 list   (or) pm ls
You will see the status as offline. This means our Node JS App is not running

Start app/services with name
pm2 start server.js --name "kastro-app1"
You will see the status as online and id as 0 and other details
Goto the browser and access the Public IP ---> You will see app

Goto Moba ---> To see the info related to the app currently running ---> pm2 show 0 (OR) pm2 show kastro-app1

Lets say you have made some code changes, to deploy the latest code changes, we will use ---> pm2 reload 0 (OR) pm2 show kastro-app1

To stop ---> pm2 stop 0 (OR) pm2 show kastro-app1
To restart ---> pm2 restart 0 (OR) pm2 show kastro-app1
To start ---> pm2 startup

Lets create one more app in the same server;
create a directory ---> mkdir myapp2 ----> cd myapp2 ----> Create server.js file. Change the port number in this file to 9090. 
Also create index.html file with some different content ----> Lets start ----> pm2 start server.js --name "kastro-app2" ---> pm2 ls ---> You will see both apps status as "online" ---> To monitor the resources ---> pm2 monit ---> select any app to see the info of that app  ---> press 'esc' to come out of the window ---> To see the logs ---> pm2 logs kastro-app1 ---> You will see the logs

Access the 2nd app in browser. Make sure to open 9090 port number



NODE Application
==================================================================================================
Lets see how to run a simple Node JS app using EC2 Instance
We will also create a simple index.html page in this demo

Launch VM - Amazon Linux 2 AMI, t2.micro
Connect to the VM
sudo su
You are in /home/ec2-user path

curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -

Run the following command to install nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash

After installation, load nvm into your shell session:
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

nvm --version

Install Node.js using nvm:
nvm install --lts

To see the list of nvm:
nvm ls-remote

nvm install 16

nvm use 16

node -v
npm -v

STEP 1: ADD REQUIRED REPO FROM OFFICIAL NODEJS WEBSITE.
curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -

STEP 2: INSTALL NODEJS.
sudo yum install -y nodejs

STEP 3: VERIFY INSTALLED VERSION.
node -v
npm -v

STEP 4: CREATE A server.js FILE AND RUN IT.
Create a file named server.js with the provided the below content.
Whenever we run this server.js file, it is going pick the content from index.html file and in this .js file we will also tell which protocol and port number has to be used.
The below script creates a http server which listens on Port 80 and it will read the content from index.html file and it will also send a response when someone access the server.
You can also change the port number, if required in the below content

vi server.js ----> Paste the below content ---->
const http = require('http');
const fs = require('fs');
const path = require('path');

const server = http.createServer((req, res) => {
  const filePath = path.join(__dirname, 'index.html');
  const stat = fs.statSync(filePath);

  res.writeHead(200, {
    'Content-Type': 'text/html',
    'Content-Length': stat.size,
  });

  const readStream = fs.createReadStream(filePath);
  readStream.pipe(res);
});

const PORT = 80;
server.listen(PORT, () => {
  console.log(`Server is running on http://localhost:${PORT}`);
});

----> esc ---> :wq
this script creates a basic web server that listens on port 80, reads the content of an index.html file, and sends it as the response when a request is made to the server. The server logs a message indicating that it is running on http://localhost:80.

Lets create the index.html file
vi index.html ---> Paste the below content ---> 

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome to Kastro-App-1</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f9;
      color: #333;
    }

    .banner {
      background-image: url('https://media.licdn.com/dms/image/v2/D5616AQEmUtBVk0Lw0Q/profile-displaybackgroundimage-shrink_350_1400/profile-displaybackgroundimage-shrink_350_1400/0/1716294939546?e=1745452800&v=beta&t=plGcHN9hOuLxuREa8Chsw4y2_muQ6vVCtaF01qGNwbE');
      background-size: cover;
      background-position: center;
      height: 200px; /* Reduced banner height */
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .header {
      font-size: 2.5rem;
      font-weight: bold;
      text-align: center;
      margin: 20px 0;
    }

    .profile-image {
      display: block;
      margin: 0 auto;
      border-radius: 50%;
      width: 150px;
      height: 150px;
      border: 5px solid #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .about-me {
      text-align: center;
      margin: 20px auto;
      max-width: 600px;
      padding: 20px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .about-me h2 {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .about-me p {
      font-size: 1.1rem;
      line-height: 1.6;
    }

    .youtube-button {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 1.2rem;
      color: #fff;
      background-color: #ff0000;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      transition: background-color 0.3s ease;
      width: fit-content;
    }

    .youtube-button:hover {
      background-color: #cc0000;
    }

    .youtube-button img {
      width: 24px;
      height: 24px;
      margin-right: 10px;
    }

    footer {
      text-align: center;
      padding: 20px;
      background-color: #333;
      color: #fff;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <div class="header">Welcome to Kastro-App-1</div>

  <div class="banner"></div>

  <div class="content">
    <img src="https://media.licdn.com/dms/image/v2/D5603AQHJB_lF1d9OSw/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1718971147172?e=1745452800&v=beta&t=TAEVuu-ImVTAJTvtMvtV4tzJV9aZM3iS4Ts1XrXAEsk" alt="Profile Image" class="profile-image">

    <div class="about-me">
      <h2>About Me</h2>
      <p><strong>Name:</strong> Kastro Kiran V</p>
      <p><strong>Role:</strong> AWS & DevOps Corporate Trainer</p>
      <p><strong>Education:</strong> PhD</p>
    </div>

    <a href="https://www.youtube.com/playlist?list=PLs-PsDpuAuTfG3gFR5DnVD58kT7JBO97x" class="youtube-button">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/YouTube_full-color_icon_%282017%29.svg/1024px-YouTube_full-color_icon_%282017%29.svg.png" alt="YouTube Icon">
      DevOps Projects
    </a>
  </div>

  <footer>
    <p>&copy; 2025 Kastro-App-1. All rights reserved.</p>
  </footer>
</body>
</html>

----> esc ---> :wq

STEP 5: INSTALL REQUIRED PACKAGES / INSTALL DEPENDENCIES.
npm install (You might see error, ignore the error).

STEP 6: NODE.JS WILL INTERPRET AND EXECUTE THE CODE IN THE server.js FILE. THIS IS A COMMON PATTERN FOR RUNNING SERVER-SIDE JAVASCRIPT APPLICATIONS.
node server.js

Goto the browser and access the Public IP ---> You will see app
Make sure to open port 80 for VM

Goto Moba and press Control + c. The website gets interrupted. 
Go to the browser and refresh. You will see "This site cant be reached". This is because the app is running in interactive mode.

So we need to run this in detached mode. For this we need to work with pm2

Command to install pm2
npm install -g pm2

list all running processes/apps.
pm2 list   (or) pm ls
You will see the status as offline. This means our Node JS App is not running

Start app/services with name
pm2 start server.js --name "kastro-app1"
You will see the status as online and id as 0 and other details
Goto the browser and access the Public IP ---> You will see app

Goto Moba ---> To see the info related to the app currently running ---> pm2 show 0 (OR) pm2 show kastro-app1

Lets say you have made some code changes, to deploy the latest code changes, we will use ---> pm2 reload 0 (OR) pm2 show kastro-app1

To stop ---> pm2 stop 0 (OR) pm2 show kastro-app1
To restart ---> pm2 restart 0 (OR) pm2 show kastro-app1
To start ---> pm2 startup

Lets create one more app in the same server;
create a directory ---> mkdir myapp2 ----> cd myapp2 ----> Create server.js file. Change the port number in this file to 9090. 
Also create index.html file with some different content ----> Lets start ----> pm2 start server.js --name "kastro-app2" ---> pm2 ls ---> You will see both apps status as "online" ---> To monitor the resources ---> pm2 monit ---> select any app to see the info of that app  ---> press 'esc' to come out of the window ---> To see the logs ---> pm2 logs kastro-app1 ---> You will see the logs

Access the 2nd app in browser. Make sure to open 9090 port number























